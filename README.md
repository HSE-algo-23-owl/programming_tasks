# Задание №12  
# Оптимальное расписание. Ленточная стратегия.
## Задачи  
1. В файле schedule_pack/schedule.py реализовать два приватных метода класса Schedule.
    - __calculate_duration(self) -> float: Вычисляет и возвращает минимальную    продолжительность расписания.
    - __fill_schedule_for_each_executor(self) -> None: Процедура составляет расписание из элементов ScheduleItem для каждого исполнителя, на основе исходного списка задач и общей продолжительности расписания.
2. Для получения повышенного балла можно по предварительному согласованию выполнить дополнительное задание:
    - Разработать диаграмму классов пакета schedule_pack с использованием библиотеки (mermaid-js)[https://github.com/mermaid-js/mermaid#class-diagram-docs---live-editor]
    - Реализовать вывод полученного от класса Schedule расписания в формате диаграммы Ганта библиотеки (mermaid-js)[https://github.com/mermaid-js/mermaid#gantt-chart-docs---live-editor]
    - Добавить новые методы для класса Schedule, для вывода времени простоя для каждого исполнителя и общего времени простоя для всего расписания.
    - Добавить метод для класса Schedule, для изменения количества исполнителей и перерасчета расписания.
    - Добавить метод для класса Schedule, для изменения состава задач и перерасчета расписания.
    - Добавить метод для класса Schedule с предложенной функциональностью.
## Примечания 
- **В файле main.py представлен только пример использования пакета schedule_pack, задание необходимо выполнять в файле schedule_pack/schedule.py**.
- Для решения задачи составления оптимального расписания с использованием Ленточной стратегии подготовлен python-пакет schedule_pack.
- Python-пакет schedule_pack реализован в объектно-ориентированной парадигме.
- Обратить внимание, что некоторые тесты ожидают вызов определенного вида исключения с заданным сообщением об ошибке.
- В пакете представлены следующие классы
    * Task: Представляет задачу для составления расписания. Используется в качестве входных данных для класса Schedule.
    * Schedule: Представляет оптимальное расписание для списка задач и количества исполнителей. Для каждого исполнителя расписание представлено набором экземпляров класса ScheduleItem.
    * ScheduleItem: Представляет собой элемент расписания, включает в себя задачу, выполняющуюся в течение некоторого времени, с указанием моментов начала и окончания ее выполнения.
- Проверить реализацию класса Schedule можно запустив набор авто-тестов в файле schedule_pack/tests/test_schedule.py.
- Запустить тесты для проверки всего пакета schedule_pack можно с помощью файла test_runner.py.

## Ленточная стратегия
### Постановка задачи:  
1. Количество заданий произвольно;  
2. Каждое задание имеет собственную длительность;  
3. Задания независимы - несколько заданий может выполняться разными исполнителями одновременно, но в каждый момент времени одно задание должно выполняться только одним исполнителем;  
4. Разрешены прерывания при выполнении заданий - задание прерванное одним исполнителем может быть продолжено другим;  
5. Количество исполнителей произвольно, но не меняется в ходе выполнения заданий;  
6. Исполнители универсальны, то есть могут выполнять любые задания;  
7. Требуется построить расписание выполнения всех заданий в кратчайшие сроки.

### Алгоритм:
1. Необходимо выбрать наибольшую длительность T<sub>max</sub> среди заданий.    

$$  
T_{max} = max\{t_1, t_2, ..., t_n\}  
$$  

где t<sub>n</sub> - задание с номером n.  
2. Необходимо рассчитать среднюю продолжительность заданий для одного исполнителя T<sub>avg</sub>, то есть разделить сумму продолжительностей заданий на количество исполнителей.    

$$  
T_{avg} = \frac {\sum_{i=1}^n  t_i}{k}  
$$  

где k - количество исполнителей.  
3. Длительность оптимального расписания T<sub>opt</sub> определяется как максимум из рассчитанных ранее средней продолжительности для исполнителя и наибольшей длительности заданий.  

$$  
T_{opt} = max\{T_{max} , T_{avg}\}  
$$  

4. Задания в исходном порядке разрезаются на "ленты" длиной T<sub>opt</sub>, которые распределяются по исполнителям, при этом "разрез ленты" может производиться внутри задания, что означает прерывание данного задания. Ленты могут представляться в виде диаграммы Ганта.

```mermaid
gantt
    title Диаграмма Ганта - Ленточная стратегия для 5 исполнителей
    dateFormat  HH:mm    
    axisFormat %H:%M
    Начало выполнения работ : milestone, m1, 00:00, 0h
    section Исполнитель 1
    Задача A         :a1, 00:00, 3h
    Задача B         :a2, after a1, 4h
    Задача C         :a3, after a2, 6h
    Задача D         :after a3, 4h
    section Исполнитель 2
    Задача D         :b1, 00:00, 3h
    Задача E         :b2, after b1, 7h
    Задача F         :after b2, 7h
    section Исполнитель 3
    Задача F         :c1, 00:00, 2h
    Задача G         :c2, after c1, 10h
    Задача H         :after c2, 5h
    section Исполнитель 4
    Задача H         :d1, 00:00, 7h
    Задача I         :after d1, 10h
    section Исполнитель 5
    Задача I         :00:00, 7h
    Окончание выполнения работ : milestone, m2, 17:00, 0h
```
