# Алгоритм Нидлмана-Вунша

## Описание алгоритма:
Алгоритм Нидлмана-Вунша это алгоритм для выполнения выравнивания двух последовательностей, который используется в биоинформатике при построении выравниваний аминокислотных или нуклеотидных последовательностей. Он является примером динамического программирования.

## Входные данные:
Две последовательности: последовательность 1 и последовательность 2, в виде строк символов. Значения штрафов за совпадение, несовпадение или пропуск.

## Выходные данные:
Матрица выравнивания: матрица, которая показывает степень сходства между символами двух последовательностей.

## Оптимальное выравнивание:
Оптимальное выравнивание последовательностей с учетом заданных штрафов за расхождения в символах.

## Сообщения об ошибке 
- "Последовательность не должна быть пустой".
- "Штраф должен быть числом"

## Области допустимых значений:

Последовательности не должны быть пустыми.

Длина последовательностей может быть любой, но сложность алгоритма составляет O(nm), где n и m - длины последовательностей, поэтому при больших значениях длин это может быть ресурсозатратно (Однако важно учитывать, что существующее специализированное ПО, реализующее алгоритм Нидлмана-Вунша (например, Mega) работает за то же время, что и написанный нами алгоритм. Для быстрой демонстрации работы алгоритма лучше использовать последовательности длиной до 20 символов).
Значения штрафов являются вещественными числами.

Стандартные штрафы: Match = 0
Mismatch = -1Gap = -1

Однако в зависимости от задачи значения штрафов можно менять (например, если для выбранных последовательностей пропуски являются критичными, то штраф за него можно уменьшить).

## Пример решения:

Выравниваем последовательности "GATTACA" И "GTCGACGCA".

Штрафы:
- Match = 1
- Mismatch = -1
- Gap = -2
  
В начальной матрице строки и столбцы представляют последовательности, и первый ряд и первая колонка заполняются штрафами за гэп:

|     |  -  |  G  |  T  |  C  |  G  |  A  |  C  |  G  |  C  |  A  |
|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
|  -  |  0  | -2  | -4  | -6  | -8  | -10 | -12 | -14 | -16 | -18 |
|  G  | -2  |     |     |     |     |     |     |     |     |     |
|  A  | -4  |     |     |     |     |     |     |     |     |     |
|  T  | -6  |     |     |     |     |     |     |     |     |     |
|  T  | -8  |     |     |     |     |     |     |     |     |     |
|  A  | -10 |     |     |     |     |     |     |     |     |     |
|  C  | -12 |     |     |     |     |     |     |     |     |     |
|  A  | -14 |     |     |     |     |     |     |     |     |     |

Далее заполняем матрицу по формуле:

$$D(i, j) = \max \begin{cases} D(i-1, j-1) + \text{match/mismatch}, & \text{если } x_i = y_j \text{ или } x_i \neq y_j \\
D(i-1, j) + \text{gap}, & \text{вставка гэпа в последовательность y} \\
D(i, j-1) + \text{gap} & \text{вставка гэпа в последовательность x} 
\end{cases}$$

Полученная матрица:

|     |  -  |  G  |  T  |  C  |  G  |  A  |  C  |  G  |  C  |  A  |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|  -  |  0  | -2  | -4  | -6  | -8  | -10 | -12 | -14 | -16 | -18 |
|  G  | -2  |  1  | -1  | -3  | -5  | -7  | -9  | -11 | -13 | -15 |
|  A  | -4  | -1  |  0  | -2  | -4  | -4  | -6  | -8  | -10 | -12 |
|  T  | -6  | -3  |  0  | -1  | -3  | -5  | -5  | -7  | -9  | -11 |
|  T  | -8  | -5  | -2  | -1  | -2  | -4  | -6  | -6  | -8  | -10 |
|  A  | -10 | -7  | -4  | -3  | -2  | -1  | -3  | -5  | -7  | -7  |
|  C  | -12 | -9  | -6  | -3  | -4  | -3  |  0  | -2  | -4  | -6  |
|  A  | -14 | -11 | -8  | -5  | -4  | -3  | -2  | -1  | -3  | -3  |

После заполнения матрицы, следующим шагом является восстановление выравнивания путем обратного прохода по матрице, начиная с правой нижней клетки. Используем следующую формулу для обратного прохода:

$$D(i, j) = \max \begin{cases} 
D(i-1, j-1) + \text{match/mismatch}, & \text{если } x_i = y_j \text{ или } x_i \neq y_j \\
D(i-1, j) + \text{gap}, & \text{вставка гэпа в последовательность y} \\
D(i, j-1) + \text{gap} & \text{вставка гэпа в последовательность x} 
\end{cases}$$

То есть:
- Если текущая клетка (i, j) получена из (i-1, j-1), значит, xi и yj выровнены.
- Если текущая клетка (i, j) получена из (i-1, j), значит, xi выровнена с гэпом в y.
- Если текущая клетка (i, j) получена из (i, j-1), значит, yi выровнена с гэпом в x.

Тогда для клетки с координатами (9;7) получаем:

$-4 + 1 = -2$

$-3 - 2 = -5$

$-6 - 2 = -8$

Максимальное значение -2, так что переходим в клетку (8;6), а последним символом в обеих последовательностях становится А.
Далее для клетки (8;6):

$-5 + 1 = -4$
   
$-2 - 2 = -4$
   
$-7 - 2 = -9$

Так как максимальные значения совпадают, то можно выбрать или переход в клетку (7;5) и запись C как предпоследнего символа в обеих последовательностях, или переход в клетку (7;6) и запись гэпа (-) в качестве предпоследнего символа второй последовательности (так как при реализации алгоритма было принято решение не обращать внимание на score выравнивания, то можно выбирать). Выбираем второй вариант.

Далее в результате обратного прохода получаем последовательности:
- GTCGACGCA
- GATTAC--A
